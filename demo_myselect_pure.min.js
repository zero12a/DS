/*
https://github.com/zero12a/anyselect
*/
var myframe=myframe||{};myframe.myselect=function(obj,cfg){var self=this;this.cfg=cfg;if(this.cfg.label===undefined)this.cfg.label="Select options";if(this.cfg.data===undefined)this.cfg.data=[];if(this.cfg.height===undefined)this.cfg.height="200px";if(this.cfg.width===undefined)this.cfg.width="150px";if(this.cfg.list_height===undefined)this.cfg.list_height="32px";if(this.cfg.text_selectall===undefined)this.cfg.text_selectall="Select all";if(this.cfg.text_unselectall===undefined)this.cfg.text_unselectall="Unselect all";this.obj=obj;this.obj_id=obj.attr("id");this.pop_div_id=this.obj_id+"_div";this.pop_selectall_div_id=this.obj_id+"_selectall_div";this.is_pop_selectall=false;this.pop_ul_id=this.obj_id+"_ul";this.pop_li_id=this.obj_id+"_li";this.pop_chk_id=this.obj_id+"_chk";obj.css("cursor","pointer");obj.css("overflow","hidden");obj.css("position","relative");obj.html("<div style='position:absolute;margin:2px 2px 2px 2px;'>"+this.cfg.label+"</div>");var pop='<div class="myselect" id="'+this.pop_div_id+'" style="height:'+this.cfg.height+";width:"+this.cfg.width+';position:absolute;overflow-y:auto;overflow-x:hidden;">';pop+='<div class="myselectSelectAllDiv" id='+this.pop_selectall_div_id+' style="line-height:'+this.cfg.list_height+";vertical-align: middle;height:"+this.cfg.list_height+';cursor:pointer;text-decoration:underline;">'+this.cfg.text_selectall+"</div>";pop+='<ul id="'+this.pop_ul_id+'" class="myselectUl"></ul>';pop+="</div>";$("body").append(pop);$("#"+this.pop_selectall_div_id).click(function(e){var obj2=$(e.target);if(self.is_pop_selectall){self.is_pop_selectall=false;obj2.html(self.cfg.text_selectall)}else{self.is_pop_selectall=true;obj2.html(self.cfg.text_unselectall)}$("input[id="+self.pop_chk_id+"").prop("checked",self.is_pop_selectall);self.makeLabel()});this.makeLabel=function(){var label=this.getLabel();if(label==""){this.obj.children().html(this.cfg.label)}else{this.obj.children().html(this.getLabel())}if(this.obj.width()<this.obj.children().width()){var label=this.getSelectedCount()+" selected.";this.obj.children().html(label)}};this.getSelectedCount=function(){return $("input[id="+this.pop_chk_id+"]:checked").length};this.getLabel=function(){var chk1=$("input[id="+this.pop_chk_id+"]");var rtnVal="";for(j=0;j<chk1.length;j++){if(chk1[j].checked){if(rtnVal!="")rtnVal+=", ";rtnVal+=$(chk1[j]).parent("li").text()}}return rtnVal};this.loadData=function(t){$("#"+this.pop_selectall_chk_id).prop("checked",false);$("#"+this.pop_ul_id).empty();for(j=0;j<t.length;j++){cd=t[j].cd;nm=t[j].nm;$("#"+this.pop_ul_id).append('<li class="myclassLi" id="'+this.pop_li_id+'" style="line-height:'+this.cfg.list_height+";vertical-align: middle;height:"+this.cfg.list_height+';cursor:pointer;"><input id="'+this.pop_chk_id+'" value="'+cd+'" type="checkbox">'+nm+"</li>")}$("li[id="+this.pop_li_id+"]").click(function(e){var liObj=$(e.target);if(liObj.children().length>0){childObj=liObj.children("input")[0];if(childObj.checked){childObj.checked=false}else{childObj.checked=true}self.makeLabel()}});$("input[id="+this.pop_chk_id+"]").click(function(e){self.makeLabel()});this.makeLabel()};this.setValue=function(t){var chk1=$("input[id="+this.pop_chk_id+"]");var setVal=t.split(",");for(j=0;j<chk1.length;j++){chk1[j].checked=false;for(t=0;t<setVal.length;t++){if(setVal[t]==chk1[j].value){chk1[j].checked=true}}}this.makeLabel()};if(cfg.data.length>0){this.loadData(cfg.data)}this.getValue=function(){var chk1=$("input[id="+this.pop_chk_id+"]");var rtnVal="";for(j=0;j<chk1.length;j++){if(chk1[j].checked){if(rtnVal!="")rtnVal+=",";rtnVal+=chk1[j].value}}return rtnVal};this.click=function(){this.toggle()};this.toggle=function(){var objoffset=this.obj.offset();var left=objoffset.left;var top=objoffset.top+this.obj.height()+2;var pop=$("#"+this.pop_div_id);pop.css("left",left);pop.css("top",top);if(pop.attr("data-show")==null){pop.attr("data-show","")}else{pop.removeAttr("data-show")}};obj.click(function(){self.click()});$(document).on("click touchend",function(e){var obj_btn=$("#"+self.obj_id);var obj_pop_div=$("#"+self.pop_div_id);var obj_pop_selectall_div=$("#"+self.pop_selectall_div_id);var obj_pop_li=$("li[id="+self.pop_li_id+"]");var obj_pop_chk=$("input[id="+self.pop_chk_id+"]");var target=$(e.target);if(target.is(obj_btn)){}else if(target.is(obj_btn.children())){}else if(target.is(obj_pop_div)){}else if(target.is(obj_pop_selectall_div)){}else if(target.is(obj_pop_li)){}else if(target.is(obj_pop_chk)){}else{for(j=0;j<obj_pop_li.length;j++){if(target.is(obj_pop_li[j])){return}}for(i=0;i<obj_pop_chk.length;i++){if(target.is(obj_pop_chk[i]))return}var pop=$("#"+self.pop_div_id);if(pop.attr("data-show")!=null)pop.removeAttr("data-show")}})};